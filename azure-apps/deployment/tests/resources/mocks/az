#!/bin/bash
# Mock az CLI for unit tests
# Logs all invocations to AZ_CALL_LOG (one line per call)
# Returns AZ_MOCK_RESPONSE file content if configured
# Returns AZ_MOCK_EXIT_CODE (default: 0)

if [ -n "${AZ_CALL_LOG:-}" ]; then
  echo "$*" >> "$AZ_CALL_LOG"
fi

# Return mock response if configured
if [ -n "${AZ_MOCK_RESPONSE:-}" ] && [ -f "$AZ_MOCK_RESPONSE" ]; then
  cat "$AZ_MOCK_RESPONSE"
fi

exit "${AZ_MOCK_EXIT_CODE:-0}"
