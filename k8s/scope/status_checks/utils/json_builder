#!/bin/bash

# Function to create a check result JSON
# Usage: create_check_result "name" "description" "status" "evidence_json"
create_check_result() {
    local name="$1"
    local description="$2"
    local status="$3"  # passed, failed, warning
    local evidence="$4"  # JSON string with evidence data

    jq -nc \
      --arg name "$name" \
      --arg description "$description" \
      --arg status "$status" \
      --argjson evidence "$evidence" \
      '{
          checkName: $name,
          description: $description,
          status: $status,
          evidence: $evidence,
          timestamp: (now | strftime("%Y-%m-%dT%H:%M:%SZ"))
      }' | tee "$CHECK_OUTPUT_FILE"
}

# Function to add pod details to evidence
add_pod_evidence() {
    local pod_name="$1"
    local details="$2"  # JSON string

    jq -n \
        --arg pod "$pod_name" \
        --argjson details "$details" \
        '{
            podName: $pod,
            details: $details
        }'
}