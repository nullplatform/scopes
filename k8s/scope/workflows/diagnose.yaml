continue_on_error: true
steps:
  - name: build context
    type: script
    file: "$SERVICE_PATH/diagnose/build_context"
    output:
      - name: CONTEXT
        type: environment
      - name: LABEL_SELECTOR
        type: environment
  - name: load_functions
    type: script
    file: "$SERVICE_PATH/diagnose/utils/diagnose_utils"
    output:
      - name: update_check_result
        type: function
        parameters:
          status: string
          evidence: object
      - name: notify_results
        type: function
  - name: diagnose
    type: executor
    before_each:
      name: notify_check_running
      type: script
      file: "$SERVICE_PATH/diagnose/notify_check_running"
    after_each:
      name: notify_check_results
      type: script
      file: "$SERVICE_PATH/diagnose/notify_diagnose_results"
    folders:
      - "$SERVICE_PATH/diagnose/service"
      - "$SERVICE_PATH/diagnose/scope"